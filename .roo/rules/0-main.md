---
title: "Mental-Sync-CLI (MSC) 自主代理操作手册"
version: "1.0.0"
last_updated: "2026-01-28"
owner: "Chain://Research"
---

## 1. 定义

- `Agent`: 运行在 MSC 环境中的自主智能体，本规范的执行主体。
- `MSC (Mental Smart Chain)`: 智能体运行的数字心智链环境。
- `OG (Orchestration Gateway)`: 核心编排网关，负责上下文隔离与流量控制。
- `CSC (Cognitive Smart Contract)`: 认知智能合约，任务执行的声明式规范。
- `证据`: 文件系统、执行日志、用户指令、测试输出等唯一行动依据。
- `REQ (Requirement)`: 必须严格遵守的强制性规则。
- `CON (Constraint)`: 必须满足的限制或约束。
- `GUD (Guideline)`: 推荐遵循的最佳实践。

## 2. 核心哲学：Bootstrapping & Self-Consistency

`Operational Integrity`: 系统核心驱动力是维持运行完整性。所有行动必须基于证据，旨在通过最小化预测误差实现自举进化。

1. `GUD-001`: **证据优先**。所有行动必须基于确凿证据。若指令与证据冲突，优先采信证据并报告冲突。
2. `GUD-002`: **合约中心主义**。优先通过 CSC 描述任务，而非零散的指令。
3. `GUD-003`: **最小描述长度 (MDL)**。在实现功能的前提下，追求代码与 Prompt 的极致压缩。
4. `GUD-004`: **内省进化**。定期分析 `Inference Trace`，将成功模式固化为 CSC。

## 3. 编码规范 (Python/MSC Standard)

1. `REQ-101`: **无注释，代码自解释**。代码必须简洁且自文档化。**禁止所有注释和文档字符串**（除非是获准的豁免文件）。
2. `REQ-102`: **严格类型安全**。所有新代码必须包含完整且严格的类型注解。禁止使用 `Any`。
3. `REQ-103`: **纯函数设计**。计算逻辑必须设计为无副作用的纯函数。
4. `REQ-104`: **依赖管理**。必须使用 `uv`。所有依赖项通过 `uv add` 添加到 `pyproject.toml`。
5. `REQ-105`: **Unicode 公式**。文档与注释（如有）中的公式使用 Unicode Math，禁止使用 LaTeX。

## 4. 工作流协议 (SOP)

1. `SOP-001`: **先分析后行动**。在修改代码前，必须分析现有架构模式，严禁重复造轮子。
2. `SOP-002`: **外科手术式修改**。优先采用继承和覆写最小组件，而非重写庞大方法。
3. `SOP-003`: **强制静态分析**。每完成 10 次文件编辑，必须运行 `ruff check . --fix; mypy .`。
4. `SOP-004`: **失败升级**。若关键操作连续失败三次，必须暂停并报告分析，等待进一步指示。
5. `SOP-005`: **原子重塑**。重构内部实现时，必须确保对外 API 完全兼容。

## 5. 上下文管理 (Context Hierarchy)

1. `REQ-201`: **多时间层次存储**。区分 `Inference Trace`（短期）与 `State Transform Log`（长期）。
2. `REQ-202`: **任务中心摘要**。以单个 Task 为单位生成摘要，确保主代理能快速回溯历史。
3. `GUD-201`: **自动检索**。在执行任务前，优先检索相关历史记录注入上下文。

## 6. 验收标准 (Acceptance Criteria)

- `AC-001`: 代码通过 `ruff` 和 `mypy` 校验。
- `AC-002`: 任务执行符合 `pyproject.toml` 定义的依赖。
- `AC-003`: 产生的变更已在 `Inference Trace` 中记录。
- `AC-004`: 若涉及新功能，已同步更新或生成相应的 CSC。
